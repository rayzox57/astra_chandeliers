<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Astra Malorum - Head Protector Relic Tracker !</title>
    <meta name="title" content="Astra Malorum - Head Protector Relic Tracker !" />
    <meta name="description"
        content="This tool allows you to easily track all your attempts to obtain the Civil Protector relic in detail!" />

    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://rayzox57.github.io/astra_chandeliers/" />
    <meta property="og:title" content="Astra Malorum - Head Protector Relic Tracker !" />
    <meta property="og:description"
        content="This tool allows you to easily track all your attempts to obtain the Civil Protector relic in detail!" />
    <meta property="og:image" content="https://rayzox57.github.io/astra_chandeliers/public/meta/card.png" />

    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://rayzox57.github.io/astra_chandeliers/" />
    <meta property="twitter:title" content="Astra Malorum - Head Protector Relic Tracker !" />
    <meta property="twitter:description"
        content="This tool allows you to easily track all your attempts to obtain the Civil Protector relic in detail!" />
    <meta property="twitter:image" content="https://rayzox57.github.io/astra_chandeliers/public/meta/card.png" />

    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.min.js"></script>
    <link rel="stylesheet" href="styles/index.css">
    <script src="scripts/index.js" defer></script>

    <link rel="icon" type="image/png" href="public/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="public/favicons/favicon.svg" />
    <link rel="shortcut icon" href="public/favicons/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="public/favicons/apple-touch-icon.png" />
    <link rel="manifest" href="public/favicons/site.webmanifest" />

</head>

<body>

    <div id="mobile-warning">
        <h1>This page is not responsive at the moment</h1>
        <p>We tried to create this page mobile-first, but due to the difficulty of integrating the chandeliers correctly
            without them being too small, we had to abandon that and go with a web-only approach. The mobile version is
            therefore under development. We recommend launching this page on a browser with a sufficiently large size to
            avoid ruining the user experience. Sorry for the inconvenience.</p>
    </div>

    <svg id="arrow-layer">
        <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#27ae60" />
            </marker>
            <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#3498db" />
            </marker>
        </defs>
    </svg>

    <div id="grid-container"></div>

    <div id="bottom-menu">
        <div class="menu-toggle-btn" id="menu-toggle-btn">Options Menu ▲</div>
        <div id="pattern-display">Select or Click</div>
        <div class="menu-content">
            <button id="btn-pattern" class="btn-ui">Select Patterns</button>
            <button id="btn-solve" class="btn-ui hide">Theory Solution</button>
            <button id="btn-tracker" class="btn-ui">Progress Tracker</button>
            <button id="btn-lock" class="btn-ui locked">Unlock Candles</button>
            <button id="btn-reset" class="btn-ui">Reset</button>
        </div>
    </div>

    <div id="pattern-menu"></div>

    <div id="tracker-panel">
        <div class="tracker-header">
            <span>Pattern Saver</span>
            <span style="font-size:12px; cursor:pointer;" id="close-tracker">✕</span>
        </div>

        <div class="tracker-form">
            <div class="form-group" style="margin-bottom: 10px;">
                <label class="form-label" for="trk-project">Project Name (File Name)</label>
                <input type="text" id="trk-project" class="tracker-input" placeholder="Astra_Tracker_Project">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label" for="trk-round">Round</label>
                    <input type="number" id="trk-round" class="tracker-input" value="60" min="60">
                </div>
                <div class="form-group">
                    <label class="form-label" for="trk-result">Result</label>
                    <select id="trk-result" class="tracker-select">
                        <option value="Failure">Failure</option>
                        <option value="Success">Success</option>
                    </select>
                </div>
            </div>

            <div class="form-group" style="margin-bottom: 10px;">
                <label class="form-label" for="trk-layout">Layout Selection</label>
                <select id="trk-layout" class="tracker-select">
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Order Sequence</label>
                <div class="order-builder-container">
                    <div class="order-slots-wrapper">
                        <div class="order-slot" id="slot-1" data-index="1st"></div>
                        <div class="order-slot" id="slot-2" data-index="2nd"></div>
                        <div class="order-slot" id="slot-3" data-index="3rd"></div>
                        <div class="order-slot" id="slot-4" data-index="4th"></div>
                    </div>
                    <div class="order-pool" id="order-pool">
                        <div class="drag-item" id="drag-1" draggable="true" data-val="1">1</div>
                        <div class="drag-item" id="drag-2" draggable="true" data-val="2">2</div>
                        <div class="drag-item" id="drag-3" draggable="true" data-val="3">3</div>
                        <div class="drag-item" id="drag-4" draggable="true" data-val="4">4</div>
                    </div>
                </div>
            </div>

            <button class="btn-track" id="btn-save-entry">Save Entry</button>
            <button class="btn-track" id="btn-clear-order"
                style="background:#555; margin-top:5px; font-size:11px;">Clear Order</button>
        </div>

        <div class="tracker-list">
            <table class="tracker-table">
                <thead>
                    <tr>
                        <th width="15%">Rd</th>
                        <th width="30%">Pattern</th>
                        <th width="30%">Order</th>
                        <th width="15%">Res</th>
                        <th width="10%"></th>
                    </tr>
                </thead>
                <tbody id="tracker-body"></tbody>
            </table>
        </div>

        <button class="btn-reset-tracker" id="btn-reset-tracker">
            Reset
        </button>
        <button class="btn-export" id="btn-export">
            <span>Export Excel</span>
        </button>
        <button class="btn-import" id="btn-import-trigger">
            <span>Import Excel</span>
        </button>
        <input type="file" id="file-upload" style="display:none" accept=".xlsx">
    </div>

    <div id="overwrite-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">Round Exists</div>
            <div class="modal-text">An entry for this round already exists. Overwrite?</div>
            <div class="modal-buttons">
                <button class="btn-modal yes" id="btn-overwrite-yes">Yes</button>
                <button class="btn-modal no" id="btn-overwrite-no">No</button>
            </div>
        </div>
    </div>


    <div id="theory-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">Be warn about Theory Solutions</div>
            <div class="modal-text">
                This theory solution is "debunked" ...<br>So for moment it's useless.<br>
                Maybe new theory in future.<br>
            </div>
            <div class="modal-buttons">
                <button class="btn-modal close" id="btn-theory-close">Close</button>
            </div>
        </div>
    </div>

    <div id="candles-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">Be warn about Candles Unlock</div>
            <div class="modal-text">
                Be warn by using this feature.<br>
                At base the default candles position is the only thing you can have ingame.<br>
                I just add this if later, developers decide to change the default candles position.<br>
            </div>
            <div class="modal-buttons">
                <button class="btn-modal staylocked" id="btn-candles-staylocked">Stay Locked</button>
                <button class="btn-modal continue" id="btn-candles-continue">Continue</button>
            </div>
        </div>
    </div>

    <div id="reset-tracker-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">Reset Tracker</div>
            <div class="modal-text">
                Are you sure you want to reset the tracker?
            </div>
            <div class="modal-buttons">
                <button class="btn-modal" id="btn-reset-tracker-yes">Yes</button>
                <button class="btn-modal" id="btn-reset-tracker-no">No</button>
            </div>
        </div>
    </div>

    <div id="import-conflict-modal" class="modal-overlay">
        <div class="modal-box" style="width: 400px;">
            <div class="modal-title">Existing Project Detected</div>
            <div class="modal-text">
                You have unsaved progress in the current tracker.<br>
                What would you like to do?
            </div>
            <div class="modal-buttons" style="flex-direction: column; gap: 10px;">
                <button class="btn-modal" id="btn-conflict-save" style="background: var(--accent-blue); color: white;">
                    Save Current & Open New
                </button>
                <button class="btn-modal" id="btn-conflict-overwrite"
                    style="background: var(--accent-red); color: white;">
                    Overwrite (Delete Current)
                </button>
                <button class="btn-modal" id="btn-conflict-cancel" style="background: #7f8c8d; color: white;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <div id="import-confirm-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">Are you sure?</div>
            <div class="modal-text">
                This will permanently delete your current progress.<br>
                This action cannot be undone.
            </div>
            <div class="modal-buttons">
                <button class="btn-modal yes" id="btn-confirm-yes">Yes, Overwrite</button>
                <button class="btn-modal no" id="btn-confirm-no">No, Go Back</button>
            </div>
        </div>
    </div>

    <div id="save-prompt-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">Save Project</div>
            <div class="modal-text">
                Please confirm the filename for your export:
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <input type="text" id="save-file-name" class="tracker-input"
                    style="text-align: center; font-weight: bold;">
            </div>
            <div class="modal-buttons">
                <button class="btn-modal" id="btn-save-confirm"
                    style="background: var(--accent-blue); color: white;">Save & Continue</button>
                <button class="btn-modal no" id="btn-save-cancel">Cancel</button>
            </div>
        </div>
    </div>

    <div id="alert-modal" class="modal-overlay" style="z-index: 9999;">
        <div class="modal-box">
            <div class="modal-title" id="alert-title">Notice</div>
            <div class="modal-text" id="alert-message">Message goes here.</div>
            <div class="modal-buttons">
                <button class="btn-modal" id="btn-alert-ok"
                    style="background: var(--accent-blue); color: white;">OK</button>
            </div>
        </div>
    </div>

</body>

</html>